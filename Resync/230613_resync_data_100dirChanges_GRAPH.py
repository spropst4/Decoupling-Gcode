import numpy as np
import cv2
from scipy.interpolate import make_interp_spline
from scipy.interpolate import interp1d
import matplotlib.pyplot as plt
from scipy.signal import savgol_filter

# load packages
import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt
from matplotlib.ticker import MultipleLocator,FormatStrFormatter,MaxNLocator
import matplotlib.cm as cm
import matplotlib.patches as mpatches
import matplotlib.lines as mlines
import matplotlib.colors as mcol

# set default global settings
mpl.rcParams['pdf.fonttype'] = 42
mpl.rcParams['ps.fonttype'] = 42
mpl.rcParams['font.family'] = 'Arial'

SMALL_SIZE = 8
MEDIUM_SIZE = 8
BIGGER_SIZE = 8

mpl.rc('font', size=SMALL_SIZE)          # controls default text sizes
mpl.rc('axes', titlesize=SMALL_SIZE)     # fontsize of the axes title
mpl.rc('axes', labelsize=MEDIUM_SIZE)    # fontsize of the x and y labels
mpl.rc('xtick', labelsize=SMALL_SIZE)    # fontsize of the tick labels
mpl.rc('ytick', labelsize=SMALL_SIZE)    # fontsize of the tick labels
mpl.rc('legend', fontsize=SMALL_SIZE)    # legend fontsize
mpl.rc('figure', titlesize=BIGGER_SIZE)  # fontsize of the figure title
mpl.rc('figure', figsize = (5,5))      # canvas size (inches)

mpl.rcParams['lines.linewidth'] = 1
mpl.rcParams['axes.linewidth'] = .5     # set size of plot border
mpl.rcParams['xtick.major.pad']='.5'
mpl.rcParams['ytick.major.pad']='.5'

pos_on_canvas = (0.1, 0.1, 0.5, 0.9)            # position on canvas (left, bottom, width, height) - canvas in range (0,1)


'''txt file used: 2023613_resync_data_100dirChanges.txt'''
time_stamps_from_aerotech_No_Resync_1 = 79.63971520000001
time_stamps_from_aerotech_No_Resync_2 = 79.63971219999999
time_stamps_from_aerotech_No_Resync_3 = 79.63771159999999
time_stamps_from_aerotech_No_Resync_4 = 79.6397084
time_stamps_from_aerotech_No_Resync_5 = 79.6397034

time_stamps_from_aerotech_Resync_every_dir_change_1 = [0.0040073999999999995, 1.5356352, 1.6137188, 3.1443479, 3.2234341, 4.7540595, 4.8321447, 6.3627712, 6.4408569, 7.972483, 8.050565800000001, 9.581194499999999, 9.659278700000002, 11.1899058, 11.2679882, 12.7996186, 12.877700800000001, 14.4093298, 14.4894148, 16.0220456, 16.1001304, 17.630758099999998, 17.7088414, 19.239468000000002, 19.318553100000003, 20.8501816, 20.9282644, 22.4588928, 22.5369771, 24.0676034, 24.1456863, 25.6763141, 25.754398700000003, 27.2850257, 27.363110199999998, 28.8937364, 28.9718207, 30.5024488, 30.580531200000003, 32.1121604, 32.191245599999995, 33.721872000000005, 33.7999551, 35.3305839, 35.4086679, 36.9392953, 37.018379, 38.5490072, 38.6270905, 40.1577183, 40.235801099999996, 41.7664292, 41.8465164, 43.377143600000004, 43.4552252, 44.9858543, 45.0639437, 46.5945652, 46.672648200000005, 48.2032784, 48.2823611, 49.812990299999996, 49.8910741, 51.4216989, 51.499783300000004, 53.030414, 53.1084936, 54.6391214, 54.717209600000004, 56.2478324, 56.3259155, 57.8565466, 57.934628100000005, 59.4662549, 59.5453398, 61.0759684, 61.154052300000004, 62.6846787, 62.7637625, 64.2953918, 64.3754793, 65.90611229999999, 65.98418769999999, 67.5148155, 67.5939008, 69.1255289, 69.2046131, 70.7372457, 70.8163352, 72.3469552, 72.4250385, 73.9556689, 74.0347526, 75.5663799, 75.64646450000001, 77.1780947, 77.2561776, 78.7868039, 78.86488779999999, 80.3955158, 80.47360259999999]
time_stamps_from_aerotech_Resync_every_dir_change_2 = [0.0040035, 1.5366343999999998, 1.6157179000000002, 3.149355, 3.2284349000000003, 4.7590616, 4.837147600000001, 6.3677768, 6.4468588, 7.9774875000000005, 8.0555681, 9.586196900000001, 9.6652825, 11.195908, 11.2739917, 12.8056214, 12.8837054, 14.4143325, 14.4924148, 16.0230436, 16.1011278, 17.6317559, 17.709837, 19.2404653, 19.3185495, 20.8491767, 20.927259999999997, 22.458888599999998, 22.5369725, 24.0676011, 24.1456833, 25.6773133, 25.7553959, 27.2860258, 27.364107, 28.8957356, 28.9738206, 30.5044473, 30.5825297, 32.1151594, 32.193246, 33.7238714, 33.801953999999995, 35.332582499999994, 35.4136698, 36.944298, 37.0223788, 38.5540082, 38.6320932, 40.162720300000004, 40.240802, 41.7724323, 41.850517999999994, 43.381147, 43.459226, 44.989854099999995, 45.0679502, 46.598565, 46.6786496, 48.2092927, 48.2873752, 49.8189895, 49.8980745, 51.428703, 51.506785799999996, 53.0374147, 53.1154989, 54.6461245, 54.7242089, 56.2548352, 56.3329191, 57.8635469, 57.9416308, 59.4722578, 59.5503424, 61.0809676, 61.1590528, 62.6896801, 62.7677627, 64.2983904, 64.3764752, 65.9071052, 65.985193, 67.5158126, 67.59389599999999, 69.1245254, 69.20260739999999, 70.7342384, 70.8153224, 72.34595200000001, 72.42403440000001, 73.9546599, 74.0327441, 75.56337420000001, 75.6414548, 77.1720824, 77.2501665, 78.7807928, 78.8588765, 80.3895052, 80.4675892]
time_stamps_from_aerotech_Resync_every_dir_change_3 = [0.0040035, 1.5356352, 1.6137177999999999, 3.1443461999999998, 3.222431, 4.7530575, 4.831140400000001, 6.3617703, 6.439854599999999, 7.9704794, 8.049563299999999, 9.580191600000001, 9.6582768, 11.1889018, 11.2679855, 12.7986147, 12.876698399999999, 14.408327, 14.4864128, 16.0170378, 16.0951217, 17.6257491, 17.7038317, 19.2344601, 19.3125452, 20.8431711, 20.9212539, 22.4518823, 22.529966499999997, 24.060593400000002, 24.1386759, 25.6693052, 25.7473894, 27.2780168, 27.356098699999997, 28.8867287, 28.964812000000002, 30.4984413, 30.5765242, 32.1071574, 32.1852413, 33.715863, 33.7939484, 35.325575199999996, 35.4036607, 36.9342886, 37.0123696, 38.5429998, 38.621082799999996, 40.1517158, 40.229792, 41.7604217, 41.8385051, 43.3691316, 43.4472155, 44.9778419, 45.055925900000005, 46.5875553, 46.6696489, 48.200270100000004, 48.2783545, 49.8089887, 49.8870639, 51.417695200000004, 51.496777800000004, 53.030408300000005, 53.1084909, 54.6391301, 54.7182041, 56.248831100000004, 56.327915000000004, 57.8585445, 57.9366303, 59.468258199999994, 59.5463455, 61.0779675, 61.159054600000005, 62.690682699999996, 62.768765800000004, 64.2993941, 64.3784792, 65.9091097, 65.9871888, 67.51781720000001, 67.5959092, 69.1265308, 69.204611, 70.7352389, 70.81332640000001, 72.3449515, 72.4260392, 73.9566659, 74.03475040000001, 75.5653763, 75.6434592, 77.1740879, 77.2521718, 78.7827995, 78.8608821, 80.3915099, 80.4695937]
time_stamps_from_aerotech_Resync_every_dir_change_4 = [0.0039983, 1.5356457000000001, 1.6147132999999998, 3.1463425000000003, 3.2244281999999997, 4.7560547, 4.8341376, 6.3647654000000005, 6.4428487, 7.9744774, 8.053561499999999, 9.585190899999999, 9.6652768, 11.196905899999999, 11.2749884, 12.8056156, 12.8836998, 14.4143284, 14.4924097, 16.0240392, 16.1031239, 17.6347526, 17.712835, 19.2434639, 19.3215472, 20.8521744, 20.9312588, 22.4628898, 22.540972, 24.0726001, 24.1516846, 25.682311900000002, 25.7604005, 27.291023499999998, 27.3701072, 28.9017369, 28.979821100000002, 30.510448, 30.5885308, 32.1191609, 32.1992482, 33.7308734, 33.808955600000004, 35.3395861, 35.4176692, 36.9482963, 37.0263802, 38.5570068, 38.6350913, 40.1657206, 40.2438012, 41.7744292, 41.852532, 43.383139799999995, 43.461222500000005, 44.99185730000001, 45.069934800000006, 46.6025637, 46.6816483, 48.2122764, 48.2903608, 49.820988299999996, 49.899070800000004, 51.429699, 51.5077833, 53.038409200000004, 53.1164931, 54.647121899999995, 54.7252057, 56.2558312, 56.3339172, 57.864543299999994, 57.942627200000004, 59.4732559, 59.551337399999994, 61.082967, 61.1620518, 62.6936835, 62.7727632, 64.3043958, 64.3824809, 65.91310739999999, 65.9911865, 67.5228186, 67.60190159999999, 69.1345305, 69.2136149, 70.7442424, 70.822327, 72.35295359999999, 72.4310363, 73.962667, 74.0417512, 75.5723791, 75.6504602, 77.18108869999999, 77.2591792, 78.78979989999999, 78.8678821, 80.3995128, 80.4786029]
time_stamps_from_aerotech_Resync_every_dir_change_5 = [0.0039899, 1.536624, 1.6147057999999999, 3.1463335999999997, 3.2254187, 4.7570462, 4.8361301999999995, 6.3677597, 6.4468518999999995, 7.9774718, 8.0555602, 9.5861959, 9.665267, 11.1968958, 11.2749797, 12.805606299999999, 12.8836898, 14.414318100000001, 14.4924005, 16.0240301, 16.1021147, 17.6327394, 17.7118246, 19.2424534, 19.321538, 20.8531661, 20.9322502, 22.462884, 22.5409618, 24.0715893, 24.1496755, 25.6803005, 25.7593858, 27.2900142, 27.3680952, 28.898723, 28.9778102, 30.5094375, 30.588520799999998, 32.1201491, 32.1982339, 33.7288599, 33.806943700000005, 35.3375714, 35.415655, 36.9462831, 37.0243647, 38.5549933, 38.63307820000001, 40.163717600000005, 40.241799, 41.7724194, 41.850499000000006, 43.3821272, 43.4612115, 44.9928491, 45.0729263, 46.604553800000005, 46.6826373, 48.2132652, 48.2913524, 49.821976, 49.9010591, 51.433691700000004, 51.511773500000004, 53.042401, 53.1204836, 54.6511115, 54.7301986, 56.2618237, 56.3409079, 57.871536500000005, 57.9496202, 59.480246400000006, 59.55933, 61.0909591, 61.1700437, 62.701672, 62.780757799999996, 64.3113835, 64.3894677, 65.9210959, 65.9991795, 67.5298065, 67.6079093, 69.13851639999999, 69.2165996, 70.7472286, 70.82531200000001, 72.35594, 72.4340224, 73.96665089999999, 74.0447362, 75.5753625, 75.654446, 77.18707649999999, 77.26616109999999, 78.7967892, 78.87487089999999, 80.4054987, 80.4835842]

No_resync = [time_stamps_from_aerotech_No_Resync_1, time_stamps_from_aerotech_No_Resync_2,time_stamps_from_aerotech_No_Resync_3, time_stamps_from_aerotech_No_Resync_4, time_stamps_from_aerotech_No_Resync_5]
Resync = [time_stamps_from_aerotech_Resync_every_dir_change_1[-1],time_stamps_from_aerotech_Resync_every_dir_change_2[-1], time_stamps_from_aerotech_Resync_every_dir_change_3[-1], time_stamps_from_aerotech_Resync_every_dir_change_4[-1], time_stamps_from_aerotech_Resync_every_dir_change_5[-1]]

averages = [np.average(No_resync), np.average(Resync)]
stds = [np.std(No_resync), np.std(Resync)]

difference = averages[1] - averages[0]
difference_per_dir_change = difference/100
print(difference_per_dir_change)
print(stds)

diff_list = []
for i in range(len(No_resync)):
    diff_list.append(Resync[i] - No_resync[i])

average_diff_list = np.average(diff_list)
std_diff_list = np.std(diff_list)

one_dir_change_F20_A100_adds = average_diff_list/100
one_Command_F20_A100_adds = 0.02 # one command adds 0.02 s to print time

count = 0
x = []
command_add_list = []
dir_change_add_list = []
while count <= 100:
    x.append(count)
    command_add_list.append(one_Command_F20_A100_adds*count)
    dir_change_add_list.append(one_dir_change_F20_A100_adds*count)
    count += 1


plt.bar(["No Resync", "Resync"],averages)

fig = plt.figure()

plt.plot(x, command_add_list)
plt.plot(x, dir_change_add_list)







'''------------------'''

import pandas as pd
data = pd.read_csv("effect_of_numCommands_varyFeed_V3.csv", header = 0)
data2 = pd.read_csv("effect_of_numCommands_varyAccel_V3.csv", header = 0)
headers = list(data.columns.values)
headers2 = list(data2.columns.values)
# print(headers2)
# print(data.to_string())

y = []
y2 = []
for i in range(len(headers)):
    if i == 0:
        x = list(data.iloc[:,i].values)
    else:
        y.append(list(data.iloc[:, i].values))

for i in range(len(headers2)):
    if i == 0:
        x2 = list(data2.iloc[:, i].values)
    else:
        y2.append(list(data2.iloc[:, i].values))


v20_A1000 = y[1]

count = 0
index = 0
dir_change_add_list = []
command_add_F20_A1000_list = []
x = []
while count <= 1000:
    x.append(count)
    command_add_F20_A1000_list.append(v20_A1000[index] - v20_A1000[0] )
    dir_change_add_list.append(one_dir_change_F20_A100_adds*count)
    count += 10
    index += 1

fig = plt.figure()

plt.plot(x, command_add_F20_A1000_list)
plt.plot(x, dir_change_add_list)




'''------------------'''
count = 0
index = 0
dir_change_add_list = []
command_add_F20_A1000_list = []
x = []
while count <= 1000:
    x.append(count)
    command_add_F20_A1000_list.append(v20_A1000[index])
    dir_change_add_list.append(v20_A1000[0] + one_dir_change_F20_A100_adds*count)
    count += 10
    index += 1

fig = plt.figure()

plt.plot(x, command_add_F20_A1000_list)
plt.plot(x, dir_change_add_list)



plt.show()
